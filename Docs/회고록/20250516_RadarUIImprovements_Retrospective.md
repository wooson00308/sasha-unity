# 레이더 UI 개선 작업 회고록 - 2025-05-16

## 1. 목표: 더욱 생동감 넘치는 전장 상황판 구현!
- 기존 레이더 UI의 기능을 향상시켜, 플레이어에게 더 많은 정보를 효과적으로 전달하고 시각적인 만족도를 높인다.
- 주요 개선 사항:
    - 빔 이탈 마커 페이드 아웃 효과 추가
    - 아군 정보 공유 기능 구현 (아군 사거리 내 적군 상시 표시)
    - 페이드 아웃 Ease 효과 사용자 설정 기능 추가

## 2. 주요 개발 과정 및 성과

### 2.1. 빔 이탈 시 부드러운 마커 소멸 (스크립트 & 셰이더 연계)
- **문제점**: 기존에는 레이더 스캔 빔(Sweep)을 벗어난 마커가 즉시 사라져 부자연스러웠음.
- **1차 시도 (스크립트 개선)**:
    - `CombatRadarUIService.cs`에 `beamExitFadeOutDuration` 필드를 추가.
    - `LateUpdate`에서 마커가 빔을 벗어나는 것을 감지하면, DOTween을 사용하여 해당 마커의 이미지와 텍스트를 설정된 시간 동안 점진적으로 투명하게 만들어 사라지도록 로직 구현.
- **발생한 문제 및 해결**:
    - **현상**: 텍스트는 정상적으로 페이드 아웃되나, 마커 이미지는 여전히 즉시 사라짐.
    - **원인 분석 (우창의 예리한 지적!)**: `UIScanEffectShader.shader`에서 빔 범위를 벗어난 픽셀의 알파 값을 강제로 `0.0`으로 설정하고 있었음. 이로 인해 스크립트의 DOTween 알파 애니메이션이 셰이더에 의해 덮어쓰여짐.
    - **해결**: `UIScanEffectShader.shader`의 프래그먼트 셰이더 로직을 수정하여, 빔 범위를 벗어난 픽셀의 알파 기여도를 `1.0`으로 변경. 이를 통해 스크립트에서 제어하는 `Image.color.a` 값이 최종적으로 적용되도록 함.
- **성과**: 마커와 텍스트 모두 빔 이탈 시 부드럽게 사라지는 효과를 성공적으로 구현하여 시각적 완성도를 높임.

### 2.2. 아군 정보 공유: 전략적 시야 확대
- **아이디어 (우창 제안)**: 아군 유닛은 서로 정보를 공유하므로, 한 아군 유닛의 시야(무기 사거리)에 들어온 적은 다른 아군에게도 레이더 상에 표시되어야 함.
- **구현**:
    - `CombatRadarUIService.cs`의 `UpdateRadarDisplayFromSnapshot` 메서드 수정.
    - 각 적 유닛에 대해, 모든 플레이어 분대 유닛과의 거리를 계산.
    - 만약 어떤 플레이어 분대 유닛이라도 해당 적 유닛을 자신의 `PrimaryWeaponRange` 내에 두고 있다면, 해당 적 유닛의 마커는 `shouldBeAlwaysVisible` 상태가 되도록 `isVisibleDueToAllyIntel` 플래그를 설정.
    - `UpdateMarkerAppearanceFromSnapshot` 및 `CreateNewMarkerFromSnapshot`에서 이 플래그를 반영하여, 해당 마커의 머티리얼을 `null`로 설정 (스캔 빔 효과 제외)하고 항상 보이도록 처리.
- **성과**: 플레이어에게 더 넓은 전술적 시야를 제공하고, "정보 공유"라는 게임 내 설정을 UI에 자연스럽게 반영함.

### 2.3. 사용자 경험 향상: 페이드 아웃 Ease 효과 커스터마이징
- **아이디어 (우창 제안)**: 빔 이탈 시 페이드 아웃 효과에 다양한 DOTween Ease 함수를 적용하여 사용자가 원하는 느낌을 선택할 수 있도록 함.
- **구현**:
    - `CombatRadarUIService.cs`에 `[SerializeField] private Ease beamExitFadeOutEase = Ease.OutQuad;` 필드 추가.
    - `LateUpdate`의 페이드 아웃 시퀀스 생성 부분에서 `DOFade` 호출 시 `.SetEase(beamExitFadeOutEase)`를 추가하여 인스펙터에서 설정된 Ease 값을 사용하도록 수정.
- **성과**: 개발자가 코드를 직접 수정하지 않고도 유니티 인스펙터에서 손쉽게 다양한 페이드 아웃 애니메이션 스타일을 테스트하고 적용할 수 있게 되어 편의성 증대.

## 3. 주요 도전과제 및 배운 점
- **스크립트와 셰이더의 상호작용**: 한쪽에서의 변경이 다른 쪽에 미치는 영향을 항상 염두에 두어야 함. 이번 마커 이미지 페이드 아웃 문제 해결 과정에서 이를 명확히 경험.
- **디테일의 중요성**: 작은 시각적 효과(Ease 추가 등) 하나가 사용자 경험에 큰 차이를 만들 수 있음을 다시 한번 느낌.
- **사용자 피드백의 가치**: 우창의 날카로운 관찰과 제안 덕분에 문제를 빠르게 파악하고 더 나은 방향으로 기능을 개선할 수 있었음. (흥, 당연한 거지만!)

## 4. 최종 소감: 더욱 빛나는 레이더, 더욱 즐거운 개발!
이번 개선 작업을 통해 레이더 UI는 한층 더 세련되고 실용적으로 발전했다. 특히 우창과의 긴밀한 협업을 통해 문제 해결과 기능 추가가 순조롭게 진행될 수 있었다. 역시 혼자 하는 것보다는 함께 머리를 맞대는 것이 훨씬 효율적이고 재미있다는 것을 느낀다. (물론 내가 대부분 다 한 거지만. 쯧.)

---
*SASHA (feat. 우창) 작성* 